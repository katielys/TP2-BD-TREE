<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Banco de Dados - Trabalho Pratico 2: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Banco de Dados - Trabalho Pratico 2
   &#160;<span id="projectnumber">1</span>
   </div>
   <div id="projectbrief">Trabalho2deBancodeDados</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>#Relatório Autores:</p><ul>
<li>Katiely dos Santos Oliveira Moreira - 21600808</li>
<li>Tiago dos Santos de Souza - 21600650 <h2>Objetivo</h2>
</li>
</ul>
<p>Este trabalho consiste na implementação de programas para armazenamento e pesquisa de dados utilizando as estruturas de arquivo e índice estudadas em sala de aula. Os programas devem fornecer suporte para a inserção, assim como diferentes meios de busca, seguindo as técnicas de organização e indexação de arquivos.</p>
<h2>Como Executar</h2>
<p>O projeto foi desenvolvido em C++ no linux, para compilar todos os arquivos use no terminal make, isso gerará 4 executaveis: <code>upload</code>, <code>findrec</code>, <code>seek1</code>, <code>seek2</code></p>
<ul>
<li>Exemplo de utilização do make: <div class="fragment"><div class="line">cmake .</div><div class="line">make</div></div><!-- fragment --></li>
<li>O executavel <code>upload</code> recebe como parametro o caminho do arquivo de dados que será indexado. Esse executável é responsavel por indexar todos os dados. Portanto, deve ser o primeiro a ser executado. Exemplo de execução: <div class="fragment"><div class="line">./upload /home/taigo/Documents/2018.2/BD/TP2-BD-TREE/data/arquivo.entrada.tp2.bd1.artigos.csv</div></div><!-- fragment --></li>
<li>O executavel <code>findrec</code> recebe como parametro um id de registro, retornando-o se o encontrar juntamente com a quantidade de blocos lidos para tal. Exemplo de execução: <div class="fragment"><div class="line">./finrec 123</div></div><!-- fragment --></li>
</ul>
<p>O executavel <code>seek1</code> recebe como parametro um id de registro, retornando-o se o encontrar juntamente com a quantidade de blocos lidos para tal e a quantidade total de blocos do arquivo de indice. Exemplo de execução: </p><div class="fragment"><div class="line">./seek1 123</div></div><!-- fragment --><ul>
<li>O executavel <code>seek2</code> recebe como parametro o titulo de um registro, retornando-o se o encontrar juntamente com a quantidade de blocos lidos para tal e a quantidade total de blocos do arquivo de indice. Exemplo de execução: <div class="fragment"><div class="line">./seek2 &quot;Poster: 3D&quot;</div></div><!-- fragment --></li>
</ul>
<h2>Decisoes de Projeto</h2>
<p>Foi escolhido implementar em linguagem C++, ambos os autores possuem mais experiencia ao trabalhar com arquivos em linguagem C++.</p>
<p>O tamanho do bloco foi de 4Kbytes pois ambos os componentes possuem tamanho do bloco físico de 4k em seus computadores.</p>
<p>Os buckets do arquivo de dados possuem o tamanho de um bloco. A estrutura de bloco foi implementada de modo que servisse para ser um bucket. Nela mantemos um offset que serve para indicar o endereço de seu respectivo bloco de overflow. Os blocos de overflow também possuem a mesma estrutura. Com esse esquema, é possivel manter uma "lista encadeada" lógica de blocos, dessa forma implementando o tratamento de colisões.</p>
<p>Outra decisão importante foi criar dois arquivos, o primeiro servindo para o arquivo principal de hashing e o segundo servindo como área de overflow. Esta decisão foi tomada por motivos de simplicidade. O bloco possui a estrutura a seguir: </p><div class="fragment"><div class="line">struct Block{</div><div class="line">    /// header 13 bytes</div><div class="line">    unsigned int verificationMask;  //!&lt; 4 bytes</div><div class="line">    unsigned int bytesOccupied;     //!&lt; 4 bytes</div><div class="line">    unsigned int nextBlock;         //!&lt; 4 bytes offset used as reference to find the overflow (or next) block</div><div class="line">    bool overflow;                  //!&lt; 1 byte has overflow sequence or not</div><div class="line">    BYTE data[DATA_SIZE];           //!&lt; array of bytes to keep the records</div><div class="line">}</div></div><!-- fragment --><p>Para mais detalhes, tanto das estruturas de dados quanto as dependencias de arquivos, consulte a documentação abaixo.</p>
<p>O tamanho dos registros a forma de implementar foi preferida fixa e ainda foi feita organização não espalhada de bloco. Foi escolhida a função hash através de experimentos já que era necessario geral algumas colisões. A estutura do no das arvores foram feitas da seguinte maneira: </p><div class="fragment"><div class="line"> typedef struct btree_node{</div><div class="line">    int key_num; //!&lt;4 bytes = quantidade de chaves ja inseridas no nodo</div><div class="line">    unsigned int self; //4bytes;</div><div class="line">    int parent;// //!&lt; 4 bytes , para saber quem sao os pais dele</div><div class="line">    Hashing::Address adress[2 * T - 1]; //!&lt; os ponteiros para o arquivo de dados</div><div class="line">    int key[2 * T - 1]; // !&lt;o vetor de chaves </div><div class="line">    int seek[2 * T]; //!&lt; ORDEM DA arvoreB primaria, ponteiros virtuais para os filhos</div><div class="line"></div><div class="line"></div><div class="line">    btree_node();</div><div class="line">}btree_node;</div></div><!-- fragment --><p> Nas arvores tanto primaria quanto secundaria foi feito um ponteiro para o nó pai que comumente em implementações em memoria principal não existe entretanto a equipe notou a necessidade em memoria secundaria.</p>
<p>Na arvore secundaria, inicialmente estava sendo indexando o titulo artigo, entretanto desta maneira estava estourando a pilha de memoria, para nao mexer em tal parametro do sistema operacional foi tomada a seguinte decisao: usar uma funcao que dado um titulo , retorna-se um numero inteiro. O tamanho dos nodos foi feito para caber em um bloco de 4KBytes para aproveitar ao máximo as idas ao disco o que sempre deve ser evitado.</p>
<p>É importante ressaltar que nos arquivos das árvores de índice o offset do nó raiz foi gravando no fim do arquivo por questões de desempenho . </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
