<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Banco de Dados - Trabalho Pratico 2: Hashing Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Banco de Dados - Trabalho Pratico 2
   &#160;<span id="projectnumber">1</span>
   </div>
   <div id="projectbrief">Trabalho2deBancodeDados</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Hashing Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structHashing_1_1Address.html">Address</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structHashing_1_1HashInstance.html">HashInstance</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This struct is simply used to keep a instance of the hashing file, it keeps the file pointer an a counter of buckets (a.k.a. blocks) inside.  <a href="structHashing_1_1HashInstance.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structHashing_1_1OverflowArea.html">OverflowArea</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad6b0ab28d1f0193b8fac209fe17ff1b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceHashing.html#ad6b0ab28d1f0193b8fac209fe17ff1b1">createHash</a> (unsigned long numberOfRecords, unsigned int recordsPerBucket, const char *path)</td></tr>
<tr class="separator:ad6b0ab28d1f0193b8fac209fe17ff1b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad646916824563b79577a706014994879"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceHashing.html#ad646916824563b79577a706014994879">createOverflow</a> (const char *path)</td></tr>
<tr class="separator:ad646916824563b79577a706014994879"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb08378c29c66400ac2400aac89dde8d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structHashing_1_1Address.html">Address</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceHashing.html#abb08378c29c66400ac2400aac89dde8d">insertOnHashFile</a> (<a class="el" href="classArticle.html">Article</a> record, <a class="el" href="structHashing_1_1HashInstance.html">HashInstance</a> &amp;hash, <a class="el" href="structHashing_1_1OverflowArea.html">OverflowArea</a> &amp;overflow)</td></tr>
<tr class="separator:abb08378c29c66400ac2400aac89dde8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07154768e85a0b4176acd8394bd49645"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceHashing.html#a07154768e85a0b4176acd8394bd49645">insertOnOverflow</a> (<a class="el" href="classArticle.html">Article</a> &amp;record, <a class="el" href="structHashing_1_1OverflowArea.html">OverflowArea</a> &amp;overflowArea, unsigned int &amp;offset, bool &amp;needsUpdate, <a class="el" href="structHashing_1_1Address.html">Address</a> &amp;address, bool alreadyLinked=false)</td></tr>
<tr class="separator:a07154768e85a0b4176acd8394bd49645"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59f8461eeea4f2ff48ef08b73ab936fa"><td class="memItemLeft" align="right" valign="top">pair&lt; bool, pair&lt; <a class="el" href="classArticle.html">Article</a>, unsigned int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceHashing.html#a59f8461eeea4f2ff48ef08b73ab936fa">findRecord</a> (unsigned int id, <a class="el" href="structHashing_1_1HashInstance.html">HashInstance</a> &amp;hash, <a class="el" href="structHashing_1_1OverflowArea.html">OverflowArea</a> &amp;overflow)</td></tr>
<tr class="separator:a59f8461eeea4f2ff48ef08b73ab936fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a860cf9bf316cf334addd60e407ede7cf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceHashing.html#a860cf9bf316cf334addd60e407ede7cf">lookUpForRecordInOverflow</a> (unsigned int id, <a class="el" href="classArticle.html">Article</a> &amp;artAux, <a class="el" href="structHashing_1_1OverflowArea.html">OverflowArea</a> &amp;overflow, unsigned int &amp;offset, unsigned int &amp;blocksPassed)</td></tr>
<tr class="separator:a860cf9bf316cf334addd60e407ede7cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b95abc1f2edd1a1614edc129b0d0f80"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classArticle.html">Article</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceHashing.html#a4b95abc1f2edd1a1614edc129b0d0f80">getRecordByAddress</a> (<a class="el" href="structHashing_1_1Address.html">Address</a> address, <a class="el" href="structHashing_1_1HashInstance.html">HashInstance</a> &amp;hash, <a class="el" href="structHashing_1_1OverflowArea.html">OverflowArea</a> &amp;overflow)</td></tr>
<tr class="separator:a4b95abc1f2edd1a1614edc129b0d0f80"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a39c803c2262445573c6dd1303dcc3108"><td class="memItemLeft" align="right" valign="top">const unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceHashing.html#a39c803c2262445573c6dd1303dcc3108">HEADER_SIZE</a> = sizeof(u_long)</td></tr>
<tr class="separator:a39c803c2262445573c6dd1303dcc3108"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This namespace group all function that manipulate the hashing, it's important to note that in this work a buckets has the same size of a block (4096), thus the same structure is used as bucket. We decided to create two separated files, the first for the main hashing file that will contain the buckets, and the second to keep the overflow blocks. If a bucket in the main file needs a overflow block, a new overflow block will be allocated and the bucket will be updated to keep the address of his first overflow block. If needed overflow blocks can also keep address of subsequent overflow blocks, forming a logical linked list. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ad6b0ab28d1f0193b8fac209fe17ff1b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6b0ab28d1f0193b8fac209fe17ff1b1">&#9670;&nbsp;</a></span>createHash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Hashing::createHash </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>numberOfRecords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>recordsPerBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initiates the hash file, allocating empty buckets. The quantity of buckets is determinated by the math: (numberOfRecord/recordsPerBucket) + 1. We also, can use a prime number to avoid collisions.</p>
<dl class="section author"><dt>Author</dt><dd>Tiago Santos </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">numberOfRecords</td><td>Is used to determinate how many buckets the file must have. </td></tr>
    <tr><td class="paramname">recordsPerBucket</td><td>Also used to determinate how many buckets the file must have. </td></tr>
    <tr><td class="paramname">path</td><td>Path to the physical file that will keep the buckets. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad646916824563b79577a706014994879"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad646916824563b79577a706014994879">&#9670;&nbsp;</a></span>createOverflow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Hashing::createOverflow </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initiates the overflow file, allocating just putting the header (quantity of blocks inside the file) that int this moment will be 0</p>
<dl class="section author"><dt>Author</dt><dd>Tiago Santos </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">numberOfRecords</td><td>Is used to determinate how many buckets the file must have. </td></tr>
    <tr><td class="paramname">recordsPerBucket</td><td>Also used to determinate how many buckets the file must have. </td></tr>
    <tr><td class="paramname">path</td><td>Path to the physical file that will keep the buckets. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a59f8461eeea4f2ff48ef08b73ab936fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59f8461eeea4f2ff48ef08b73ab936fa">&#9670;&nbsp;</a></span>findRecord()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; bool, std::pair&lt; <a class="el" href="classArticle.html">Article</a>, unsigned int &gt; &gt; Hashing::findRecord </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structHashing_1_1HashInstance.html">Hashing::HashInstance</a> &amp;&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structHashing_1_1OverflowArea.html">Hashing::OverflowArea</a> &amp;&#160;</td>
          <td class="paramname"><em>overflow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section author"><dt>Author</dt><dd>Tiago Santos </dd></dl>

</div>
</div>
<a id="a4b95abc1f2edd1a1614edc129b0d0f80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b95abc1f2edd1a1614edc129b0d0f80">&#9670;&nbsp;</a></span>getRecordByAddress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classArticle.html">Article</a> Hashing::getRecordByAddress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structHashing_1_1Address.html">Hashing::Address</a>&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structHashing_1_1HashInstance.html">Hashing::HashInstance</a> &amp;&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structHashing_1_1OverflowArea.html">Hashing::OverflowArea</a> &amp;&#160;</td>
          <td class="paramname"><em>overflow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section author"><dt>Author</dt><dd>Tiago Santos </dd></dl>

</div>
</div>
<a id="abb08378c29c66400ac2400aac89dde8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb08378c29c66400ac2400aac89dde8d">&#9670;&nbsp;</a></span>insertOnHashFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structHashing_1_1Address.html">Hashing::Address</a> Hashing::insertOnHashFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classArticle.html">Article</a>&#160;</td>
          <td class="paramname"><em>record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structHashing_1_1HashInstance.html">Hashing::HashInstance</a> &amp;&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structHashing_1_1OverflowArea.html">Hashing::OverflowArea</a> &amp;&#160;</td>
          <td class="paramname"><em>overflow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Inserts a record in the hash file and returns its address inside the data file. Uses the hash function (see the implementation please) to get the mapped block and tries to alloc in there. If succeeds, returns the allocated address immediately. If not, tries to alloc the record in the overflow area.</p>
<dl class="section author"><dt>Author</dt><dd>Tiago Santos </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">record</td><td>Record that will be allocated. </td></tr>
    <tr><td class="paramname">hash</td><td>Current instance of the hashing. </td></tr>
    <tr><td class="paramname">overflow</td><td>Current instance of the overflow area. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a07154768e85a0b4176acd8394bd49645"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07154768e85a0b4176acd8394bd49645">&#9670;&nbsp;</a></span>insertOnOverflow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Hashing::insertOnOverflow </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classArticle.html">Article</a> &amp;&#160;</td>
          <td class="paramname"><em>record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structHashing_1_1OverflowArea.html">Hashing::OverflowArea</a> &amp;&#160;</td>
          <td class="paramname"><em>overflowArea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>needsUpdate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structHashing_1_1Address.html">Address</a> &amp;&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>alreadyLinked</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Inserts a record in the overflow file. It's a recursive implementation.</p>
<dl class="section author"><dt>Author</dt><dd>Tiago Santos </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">record</td><td>Record that will be allocated. </td></tr>
    <tr><td class="paramname">overflowArea</td><td>Current instance of the overflow area. </td></tr>
    <tr><td class="paramname">offset</td><td>Logical address (0,1,2,4,...) of the overflow block. Used to seek the block. </td></tr>
    <tr><td class="paramname">needsUpdate</td><td>Bool that indicates if the previous block in the logical linked list will need to be updated. </td></tr>
    <tr><td class="paramname">address</td><td><a class="el" href="structHashing_1_1Address.html">Address</a> object passed by reference to keep the final address of the allocated record. </td></tr>
    <tr><td class="paramname">alreadyLinked</td><td>Indicates if a bucket/block already has a subsequent linked block. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a860cf9bf316cf334addd60e407ede7cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a860cf9bf316cf334addd60e407ede7cf">&#9670;&nbsp;</a></span>lookUpForRecordInOverflow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Hashing::lookUpForRecordInOverflow </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classArticle.html">Article</a> &amp;&#160;</td>
          <td class="paramname"><em>artAux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structHashing_1_1OverflowArea.html">Hashing::OverflowArea</a> &amp;&#160;</td>
          <td class="paramname"><em>overflow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>blocksPassed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section author"><dt>Author</dt><dd>Tiago Santos </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a39c803c2262445573c6dd1303dcc3108"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39c803c2262445573c6dd1303dcc3108">&#9670;&nbsp;</a></span>HEADER_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned short Hashing::HEADER_SIZE = sizeof(u_long)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Indicates the size of header, the header is summarily used to keep tracking about the number of blocks allocated in hashing/overflow file </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
